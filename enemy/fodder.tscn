[gd_scene load_steps=45 format=3 uid="uid://d2w73s62i5iip"]

[ext_resource type="Script" path="res://enemy.gd" id="1_cyxeq"]
[ext_resource type="AudioStream" uid="uid://b4vt2efwa80k7" path="res://sounds/hitHurt.wav" id="2_715iw"]
[ext_resource type="Shader" path="res://hit_flash.gdshader" id="3_hdyio"]
[ext_resource type="Texture2D" uid="uid://qixy2jmfehm5" path="res://sprites/Jellyfish Sprite Sheet.png" id="4_wwy08"]
[ext_resource type="Script" path="res://hitbox_component.gd" id="6_155jg"]
[ext_resource type="Script" path="res://knockback_component.gd" id="7_46jtp"]
[ext_resource type="Script" path="res://hurtbox_component.gd" id="8_bwygw"]
[ext_resource type="Script" path="res://health_component.gd" id="9_s8he7"]
[ext_resource type="Script" path="res://knockable_component.gd" id="10_ssp2j"]
[ext_resource type="Script" path="res://velocity_component.gd" id="11_8l2y0"]
[ext_resource type="Script" path="res://hit_flash_component.gd" id="12_nlew5"]
[ext_resource type="PackedScene" uid="uid://b8fgwm6nhyjfc" path="res://healthbar.tscn" id="13_6kurd"]
[ext_resource type="Script" path="res://bounce_component.gd" id="14_c7qwp"]
[ext_resource type="Script" path="res://toggleable.gd" id="15_qniik"]
[ext_resource type="Script" path="res://movement_component.gd" id="16_bdhho"]
[ext_resource type="Script" path="res://particle_player.gd" id="18_t1tmq"]
[ext_resource type="Script" path="res://sound_player.gd" id="19_y4hif"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_dim6m"]
size = Vector2(4, 4)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_h34eh"]
resource_local_to_scene = true
shader = ExtResource("3_hdyio")
shader_parameter/active = false
shader_parameter/r = 1.0
shader_parameter/g = 1.0
shader_parameter/b = 1.0

[sub_resource type="AtlasTexture" id="AtlasTexture_4milv"]
atlas = ExtResource("4_wwy08")
region = Rect2(32, 64, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_g087d"]
atlas = ExtResource("4_wwy08")
region = Rect2(0, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_pwk7j"]
atlas = ExtResource("4_wwy08")
region = Rect2(32, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_j51sd"]
atlas = ExtResource("4_wwy08")
region = Rect2(64, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_1l450"]
atlas = ExtResource("4_wwy08")
region = Rect2(96, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ngp04"]
atlas = ExtResource("4_wwy08")
region = Rect2(128, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wvklu"]
atlas = ExtResource("4_wwy08")
region = Rect2(160, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_i7olu"]
atlas = ExtResource("4_wwy08")
region = Rect2(192, 96, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_y6vu5"]
atlas = ExtResource("4_wwy08")
region = Rect2(0, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wgjji"]
atlas = ExtResource("4_wwy08")
region = Rect2(32, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_5f8ti"]
atlas = ExtResource("4_wwy08")
region = Rect2(64, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_wxfs1"]
atlas = ExtResource("4_wwy08")
region = Rect2(96, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_8wiiw"]
atlas = ExtResource("4_wwy08")
region = Rect2(128, 0, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_q8h35"]
atlas = ExtResource("4_wwy08")
region = Rect2(0, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_nfsxs"]
atlas = ExtResource("4_wwy08")
region = Rect2(32, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_f385c"]
atlas = ExtResource("4_wwy08")
region = Rect2(64, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_7wyeu"]
atlas = ExtResource("4_wwy08")
region = Rect2(96, 32, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_0d7g5"]
atlas = ExtResource("4_wwy08")
region = Rect2(128, 32, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_av43m"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_4milv")
}],
"loop": true,
"name": &"Damaged",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_g087d")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_pwk7j")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_j51sd")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_1l450")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ngp04")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wvklu")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_i7olu")
}],
"loop": false,
"name": &"Death",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_y6vu5")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wgjji")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5f8ti")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_wxfs1")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_8wiiw")
}],
"loop": true,
"name": &"Idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_q8h35")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_nfsxs")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_f385c")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_7wyeu")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_0d7g5")
}],
"loop": true,
"name": &"Move",
"speed": 5.0
}]

[sub_resource type="Curve" id="Curve_p85g6"]
max_value = 100.0
_data = [Vector2(0.0159744, 18.8535), 0.0, 0.0, 0, 0, Vector2(1, 56.9427), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_slv5o"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.990415, 0.271338), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_pqwyt"]
max_value = 100.0
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.99361, 15.5414), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_lqh34"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.99361, 0.34586), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_pdin5"]
size = Vector2(5, 10)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hk3ai"]
size = Vector2(12, 18)

[node name="Fodder" type="CharacterBody2D" node_paths=PackedStringArray("health_component", "hurtbox_component", "velocity_component", "knockable_component", "particle_player", "sound_player")]
collision_layer = 8
collision_mask = 10
motion_mode = 1
wall_min_slide_angle = 0.0
script = ExtResource("1_cyxeq")
health_component = NodePath("HealthComponent")
hurtbox_component = NodePath("HurtboxComponent")
velocity_component = NodePath("VelocityComponent")
knockable_component = NodePath("KnockableComponent")
particle_player = NodePath("ParticlePlayer")
sound_player = NodePath("SoundPlayer")
hit_sound = ExtResource("2_715iw")
speed = 30
wander_range = Vector2(40, 40)
detection_range = 0.0
wander_idle_time_min = 2.5
wander_idle_time_max = 5.0

[node name="MovementCollisionShape" type="CollisionShape2D" parent="."]
position = Vector2(0, 4)
shape = SubResource("RectangleShape2D_dim6m")

[node name="Sprite" type="AnimatedSprite2D" parent="."]
material = SubResource("ShaderMaterial_h34eh")
sprite_frames = SubResource("SpriteFrames_av43m")
animation = &"Death"

[node name="RayCast2D" type="RayCast2D" parent="."]
collision_mask = 2

[node name="HitParticles" type="CPUParticles2D" parent="."]
emitting = false
lifetime = 0.5
one_shot = true
explosiveness = 1.0
randomness = 1.0
local_coords = true
direction = Vector2(-1, 0)
spread = 30.0
gravity = Vector2(0, 100)
initial_velocity_min = 50.0
initial_velocity_max = 130.0
damping_min = 2.0
damping_max = 8.0
damping_curve = SubResource("Curve_p85g6")
scale_amount_min = 0.5
scale_amount_max = 3.0
scale_amount_curve = SubResource("Curve_slv5o")
color = Color(1, 0.117647, 0.235294, 1)

[node name="DeathParticles" type="CPUParticles2D" parent="."]
emitting = false
amount = 18
lifetime = 0.3
one_shot = true
explosiveness = 1.0
randomness = 1.0
local_coords = true
direction = Vector2(0, 0)
spread = 180.0
gravity = Vector2(0, 0)
initial_velocity_min = 70.0
initial_velocity_max = 100.0
damping_max = 50.0
damping_curve = SubResource("Curve_pqwyt")
scale_amount_min = 2.0
scale_amount_max = 4.0
scale_amount_curve = SubResource("Curve_lqh34")
color = Color(1, 0.117647, 0.235294, 1)

[node name="Label" type="Label" parent="."]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -49.5
offset_top = -11.5
offset_right = 49.5
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/font_size = 6
text = "WANDERING"
horizontal_alignment = 1
vertical_alignment = 1

[node name="HitboxComponent" type="Area2D" parent="."]
collision_layer = 8
script = ExtResource("6_155jg")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitboxComponent"]
position = Vector2(0.5, 1)
shape = SubResource("RectangleShape2D_pdin5")

[node name="KnockbackComponent" type="Area2D" parent="."]
collision_layer = 8
script = ExtResource("7_46jtp")

[node name="CollisionShape2D" type="CollisionShape2D" parent="KnockbackComponent"]
position = Vector2(0.5, 1)
shape = SubResource("RectangleShape2D_pdin5")

[node name="HurtboxComponent" type="Area2D" parent="." node_paths=PackedStringArray("health_component")]
collision_layer = 8
script = ExtResource("8_bwygw")
health_component = NodePath("../HealthComponent")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HurtboxComponent"]
position = Vector2(0, 1)
shape = SubResource("RectangleShape2D_hk3ai")

[node name="HealthComponent" type="Node" parent="."]
script = ExtResource("9_s8he7")
starting_health = 30

[node name="KnockableComponent" type="Area2D" parent="." node_paths=PackedStringArray("velocity_component")]
collision_layer = 8
script = ExtResource("10_ssp2j")
velocity_component = NodePath("../VelocityComponent")
mass = 1.5

[node name="CollisionShape2D" type="CollisionShape2D" parent="KnockableComponent"]
position = Vector2(0, 1)
shape = SubResource("RectangleShape2D_hk3ai")

[node name="VelocityComponent" type="Node" parent="."]
script = ExtResource("11_8l2y0")

[node name="HitFlashComponent" type="Node" parent="." node_paths=PackedStringArray("sprite")]
script = ExtResource("12_nlew5")
sprite = NodePath("../Sprite")

[node name="Healthbar" parent="." node_paths=PackedStringArray("health_component") instance=ExtResource("13_6kurd")]
offset_left = -12.0
offset_top = -16.0
offset_right = 13.0
offset_bottom = -11.0
health_component = NodePath("../HealthComponent")

[node name="BounceComponent" type="Node2D" parent="." node_paths=PackedStringArray("velocity_component", "movement_component")]
script = ExtResource("14_c7qwp")
velocity_component = NodePath("../VelocityComponent")
movement_component = NodePath("../MovementComponent")
velocity_decrease_on_bounce = 40.0

[node name="Toggleable" type="Node" parent="BounceComponent"]
script = ExtResource("15_qniik")

[node name="MovementComponent" type="Node" parent="." node_paths=PackedStringArray("body", "velocity_component")]
script = ExtResource("16_bdhho")
body = NodePath("..")
velocity_component = NodePath("../VelocityComponent")

[node name="ParticlePlayer" type="Node" parent="."]
script = ExtResource("18_t1tmq")

[node name="SoundPlayer" type="Node" parent="."]
script = ExtResource("19_y4hif")

[connection signal="hit" from="HurtboxComponent" to="HitFlashComponent" method="flash"]
[connection signal="died" from="HealthComponent" to="." method="_on_health_component_died"]
[connection signal="on_knocked_changed" from="KnockableComponent" to="." method="_on_knockable_component_on_knocked_changed"]
