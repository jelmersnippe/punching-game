[gd_scene load_steps=50 format=3 uid="uid://hbd7myjyq1it"]

[ext_resource type="Script" path="res://enemy.gd" id="1_3joco"]
[ext_resource type="AudioStream" uid="uid://b4vt2efwa80k7" path="res://sounds/hitHurt.wav" id="2_inqga"]
[ext_resource type="Shader" path="res://hit_flash.gdshader" id="3_dp03a"]
[ext_resource type="Texture2D" uid="uid://6pyye7ajm5jq" path="res://sprites/Spider Sprite Sheet.png" id="4_o3drw"]
[ext_resource type="Script" path="res://hitbox_component.gd" id="6_0olp0"]
[ext_resource type="Script" path="res://knockback_component.gd" id="7_7ot6p"]
[ext_resource type="Script" path="res://hurtbox_component.gd" id="8_66ocb"]
[ext_resource type="Script" path="res://health_component.gd" id="9_sjbmj"]
[ext_resource type="Script" path="res://knockable_component.gd" id="10_kicyr"]
[ext_resource type="Script" path="res://velocity_component.gd" id="11_hk7sa"]
[ext_resource type="Script" path="res://hit_flash_component.gd" id="12_654kt"]
[ext_resource type="PackedScene" uid="uid://b8fgwm6nhyjfc" path="res://healthbar.tscn" id="13_d0p0q"]
[ext_resource type="Script" path="res://bounce_component.gd" id="14_sbb0t"]
[ext_resource type="Script" path="res://toggleable.gd" id="15_2ullq"]
[ext_resource type="Script" path="res://movement_component.gd" id="16_5j5ae"]
[ext_resource type="Script" path="res://attacks/ranged_attack.gd" id="17_welwn"]
[ext_resource type="PackedScene" uid="uid://dumdlgl3hv18u" path="res://enemy/projectile.tscn" id="18_j37ne"]
[ext_resource type="Script" path="res://particle_player.gd" id="19_l6wyg"]
[ext_resource type="Script" path="res://sound_player.gd" id="20_2i7kf"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_dim6m"]
size = Vector2(5, 3)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_h34eh"]
resource_local_to_scene = true
shader = ExtResource("3_dp03a")
shader_parameter/active = false
shader_parameter/r = 1.0
shader_parameter/g = 1.0
shader_parameter/b = 1.0

[sub_resource type="AtlasTexture" id="AtlasTexture_7a8hw"]
atlas = ExtResource("4_o3drw")
region = Rect2(32, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_34qeb"]
atlas = ExtResource("4_o3drw")
region = Rect2(0, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_36nru"]
atlas = ExtResource("4_o3drw")
region = Rect2(32, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_6hsyw"]
atlas = ExtResource("4_o3drw")
region = Rect2(64, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_f8a3a"]
atlas = ExtResource("4_o3drw")
region = Rect2(96, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_h4ml2"]
atlas = ExtResource("4_o3drw")
region = Rect2(128, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_tp1f7"]
atlas = ExtResource("4_o3drw")
region = Rect2(160, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_gp66p"]
atlas = ExtResource("4_o3drw")
region = Rect2(192, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_m3a2a"]
atlas = ExtResource("4_o3drw")
region = Rect2(224, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ex01c"]
atlas = ExtResource("4_o3drw")
region = Rect2(256, 448, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_l0yg3"]
atlas = ExtResource("4_o3drw")
region = Rect2(0, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_lsg6k"]
atlas = ExtResource("4_o3drw")
region = Rect2(32, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_5ath4"]
atlas = ExtResource("4_o3drw")
region = Rect2(64, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_xqd35"]
atlas = ExtResource("4_o3drw")
region = Rect2(96, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_bxbmg"]
atlas = ExtResource("4_o3drw")
region = Rect2(128, 256, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_jx2fm"]
atlas = ExtResource("4_o3drw")
region = Rect2(0, 288, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_22t12"]
atlas = ExtResource("4_o3drw")
region = Rect2(32, 288, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_ce2fh"]
atlas = ExtResource("4_o3drw")
region = Rect2(64, 288, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_lj0jy"]
atlas = ExtResource("4_o3drw")
region = Rect2(96, 288, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_6006g"]
atlas = ExtResource("4_o3drw")
region = Rect2(128, 288, 32, 32)

[sub_resource type="AtlasTexture" id="AtlasTexture_k2vi6"]
atlas = ExtResource("4_o3drw")
region = Rect2(160, 288, 32, 32)

[sub_resource type="SpriteFrames" id="SpriteFrames_hthlf"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_7a8hw")
}],
"loop": true,
"name": &"Damaged",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_34qeb")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_36nru")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_6hsyw")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_f8a3a")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_h4ml2")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_tp1f7")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_gp66p")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_m3a2a")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ex01c")
}],
"loop": false,
"name": &"Death",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_l0yg3")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_lsg6k")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_5ath4")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_xqd35")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_bxbmg")
}],
"loop": true,
"name": &"Idle",
"speed": 5.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_jx2fm")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_22t12")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_ce2fh")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_lj0jy")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_6006g")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_k2vi6")
}],
"loop": true,
"name": &"Move",
"speed": 5.0
}]

[sub_resource type="Curve" id="Curve_p85g6"]
max_value = 100.0
_data = [Vector2(0.0159744, 18.8535), 0.0, 0.0, 0, 0, Vector2(1, 56.9427), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_slv5o"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.990415, 0.271338), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_pqwyt"]
max_value = 100.0
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(0.99361, 15.5414), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_lqh34"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(0.99361, 0.34586), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="RectangleShape2D" id="RectangleShape2D_pdin5"]
size = Vector2(5, 3)

[sub_resource type="RectangleShape2D" id="RectangleShape2D_hk3ai"]
size = Vector2(12, 9)

[node name="Ranged" type="CharacterBody2D" node_paths=PackedStringArray("health_component", "hurtbox_component", "velocity_component", "knockable_component", "particle_player", "sound_player", "attack")]
collision_layer = 8
collision_mask = 10
motion_mode = 1
wall_min_slide_angle = 0.0
script = ExtResource("1_3joco")
health_component = NodePath("HealthComponent")
hurtbox_component = NodePath("HurtboxComponent")
velocity_component = NodePath("VelocityComponent")
knockable_component = NodePath("KnockableComponent")
particle_player = NodePath("ParticlePlayer")
sound_player = NodePath("SoundPlayer")
hit_sound = ExtResource("2_inqga")
wander_range = Vector2(40, 40)
detection_range = 300.0
attack = NodePath("RangedAttack")
wander_idle_time_min = 3.0
wander_idle_time_max = 10.0

[node name="MovementCollisionShape" type="CollisionShape2D" parent="."]
position = Vector2(-0.5, 0.5)
shape = SubResource("RectangleShape2D_dim6m")

[node name="Sprite" type="AnimatedSprite2D" parent="."]
material = SubResource("ShaderMaterial_h34eh")
position = Vector2(0, -11)
sprite_frames = SubResource("SpriteFrames_hthlf")
animation = &"Idle"
autoplay = "Idle"

[node name="RayCast2D" type="RayCast2D" parent="."]
collision_mask = 2

[node name="HitParticles" type="CPUParticles2D" parent="."]
emitting = false
lifetime = 0.5
one_shot = true
explosiveness = 1.0
randomness = 1.0
local_coords = true
direction = Vector2(-1, 0)
spread = 30.0
gravity = Vector2(0, 100)
initial_velocity_min = 50.0
initial_velocity_max = 130.0
damping_min = 2.0
damping_max = 8.0
damping_curve = SubResource("Curve_p85g6")
scale_amount_min = 0.5
scale_amount_max = 3.0
scale_amount_curve = SubResource("Curve_slv5o")
color = Color(1, 0.117647, 0.235294, 1)

[node name="DeathParticles" type="CPUParticles2D" parent="."]
emitting = false
amount = 18
lifetime = 0.3
one_shot = true
explosiveness = 1.0
randomness = 1.0
local_coords = true
direction = Vector2(0, 0)
spread = 180.0
gravity = Vector2(0, 0)
initial_velocity_min = 70.0
initial_velocity_max = 100.0
damping_max = 50.0
damping_curve = SubResource("Curve_pqwyt")
scale_amount_min = 2.0
scale_amount_max = 4.0
scale_amount_curve = SubResource("Curve_lqh34")
color = Color(1, 0.117647, 0.235294, 1)

[node name="NavigationAgent2D" type="NavigationAgent2D" parent="."]
avoidance_enabled = true
radius = 40.0
neighbor_distance = 40.0
max_neighbors = 1
avoidance_layers = 8
avoidance_mask = 8

[node name="Label" type="Label" parent="."]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -50.0
offset_top = -5.0
offset_right = 49.0
offset_bottom = 18.0
grow_horizontal = 2
grow_vertical = 2
theme_override_font_sizes/font_size = 6
text = "WANDERING"
horizontal_alignment = 1
vertical_alignment = 1

[node name="HitboxComponent" type="Area2D" parent="."]
collision_layer = 8
script = ExtResource("6_0olp0")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HitboxComponent"]
position = Vector2(0.5, 0.5)
shape = SubResource("RectangleShape2D_pdin5")

[node name="KnockbackComponent" type="Area2D" parent="."]
collision_layer = 8
script = ExtResource("7_7ot6p")

[node name="CollisionShape2D" type="CollisionShape2D" parent="KnockbackComponent"]
position = Vector2(0.5, 0.5)
shape = SubResource("RectangleShape2D_pdin5")

[node name="HurtboxComponent" type="Area2D" parent="." node_paths=PackedStringArray("health_component")]
collision_layer = 8
script = ExtResource("8_66ocb")
health_component = NodePath("../HealthComponent")

[node name="CollisionShape2D" type="CollisionShape2D" parent="HurtboxComponent"]
position = Vector2(0, 0.5)
shape = SubResource("RectangleShape2D_hk3ai")

[node name="HealthComponent" type="Node" parent="."]
script = ExtResource("9_sjbmj")

[node name="KnockableComponent" type="Area2D" parent="." node_paths=PackedStringArray("velocity_component")]
collision_layer = 8
script = ExtResource("10_kicyr")
velocity_component = NodePath("../VelocityComponent")

[node name="CollisionShape2D" type="CollisionShape2D" parent="KnockableComponent"]
position = Vector2(0, 0.5)
shape = SubResource("RectangleShape2D_hk3ai")

[node name="VelocityComponent" type="Node" parent="."]
script = ExtResource("11_hk7sa")

[node name="HitFlashComponent" type="Node" parent="." node_paths=PackedStringArray("sprite")]
script = ExtResource("12_654kt")
sprite = NodePath("../Sprite")

[node name="Healthbar" parent="." node_paths=PackedStringArray("health_component") instance=ExtResource("13_d0p0q")]
offset_left = -12.0
offset_top = -9.0
offset_right = 13.0
offset_bottom = -4.0
health_component = NodePath("../HealthComponent")

[node name="BounceComponent" type="Node2D" parent="." node_paths=PackedStringArray("velocity_component", "movement_component")]
script = ExtResource("14_sbb0t")
velocity_component = NodePath("../VelocityComponent")
movement_component = NodePath("../MovementComponent")
velocity_decrease_on_bounce = 40.0

[node name="Toggleable" type="Node" parent="BounceComponent"]
script = ExtResource("15_2ullq")

[node name="MovementComponent" type="Node" parent="." node_paths=PackedStringArray("body", "velocity_component")]
script = ExtResource("16_5j5ae")
body = NodePath("..")
velocity_component = NodePath("../VelocityComponent")

[node name="RangedAttack" type="Node2D" parent="." node_paths=PackedStringArray("spawn_point")]
script = ExtResource("17_welwn")
projectile_scene = ExtResource("18_j37ne")
spawn_point = NodePath("..")
cooldown = 2.0
prefered_distance = 150.0

[node name="ParticlePlayer" type="Node" parent="."]
script = ExtResource("19_l6wyg")

[node name="SoundPlayer" type="Node" parent="."]
script = ExtResource("20_2i7kf")

[connection signal="hit" from="HurtboxComponent" to="HitFlashComponent" method="flash"]
[connection signal="died" from="HealthComponent" to="." method="_on_health_component_died"]
[connection signal="on_knocked_changed" from="KnockableComponent" to="." method="_on_knockable_component_on_knocked_changed"]
